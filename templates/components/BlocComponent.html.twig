<div{{ attributes }}>
    <div class="offcanvas offcanvas-start" data-bs-scroll="true"
         data-bs-backdrop="false" tabindex="-1" id="offcanvasScrolling{{ bloc.id }}"
         aria-labelledby="offcanvasScrollingLabel">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="offcanvasScrollingLabel">Paramètres du
                bloc</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas"
                    aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <h6>Alignements</h6>
            <a href="{{ path('app_portfolio_perso_bloc_justify', {'portfolioId': portfolioPerso.id, 'id': bloc.id, 'justify': 'justify-content-start'}) }}">
                <button class="btn"><i
                            class="fa-solid fa-objects-align-left fa-xl"></i>
                </button>
            </a>
            <a href="{{ path('app_portfolio_perso_bloc_justify', {'portfolioId': portfolioPerso.id, 'id': bloc.id, 'justify': 'justify-content-end'}) }}">
                <button class="btn"><i
                            class="fa-solid fa-objects-align-right fa-xl"></i>
                </button>
            </a>
            <a href="{{ path('app_portfolio_perso_bloc_justify', {'portfolioId': portfolioPerso.id, 'id': bloc.id, 'justify': 'justify-content-around'}) }}">
                <button class="btn"><i
                            class="fa-solid fa-objects-align-center-horizontal fa-xl"></i>
                </button>
            </a>
            <a href="{{ path('app_portfolio_perso_bloc_direction', {'portfolioId': portfolioPerso.id, 'id': bloc.id, 'direction': 'flex-row'}) }}">
                <button class="btn"><i class="fa-solid fa-objects-column fa-xl"></i><i
                            class="fa-solid fa-arrow-right fa-xs"></i></button>
            </a>
            <a href="{{ path('app_portfolio_perso_bloc_direction', {'portfolioId': portfolioPerso.id, 'id': bloc.id, 'direction': 'flex-column'}) }}">
                <button class="btn"><i class="fa-solid fa-objects-column fa-xl"></i><i
                            class="fa-solid fa-arrow-down fa-xs"></i></button>
            </a>
            <hr>
            <h6>Couleurs</h6>
            <a href="#" style="display:flex; align-items: center; width: fit-content">
                <div style="width: 25px; height: 25px; border-radius: 50%; border: solid 1px grey"></div>
                <button class="btn">Texte</button>
            </a>
            <a href="#" style="display:flex; align-items: center; width: fit-content">
                <div style="width: 25px; height: 25px; border-radius: 50%; border: solid 1px grey"></div>
                <button class="btn">Arrière plan</button>
            </a>
            <hr>
            <h6>Typographie</h6>
            <a href="{{ path('app_portfolio_perso_bloc_font_size', {'portfolioId': portfolioPerso.id, 'id': bloc.id, 'fontSize': '13px'}) }}">
                <button class="btn"><i class="fa-solid fa-text fa-xs"></i>
                    <br>
                    13px
                </button>
            </a>
            <a href="{{ path('app_portfolio_perso_bloc_font_size', {'portfolioId': portfolioPerso.id, 'id': bloc.id, 'fontSize': '16px'}) }}">
                <button class="btn"><i class="fa-solid fa-text fa-sm"></i>
                    <br>
                    16px
                </button>
            </a>
            <a href="{{ path('app_portfolio_perso_bloc_font_size', {'portfolioId': portfolioPerso.id, 'id': bloc.id, 'fontSize': '20px'}) }}">
                <button class="btn"><i class="fa-solid fa-text fa-l"></i>
                    <br>
                    20px
                </button>
            </a>
            <a href="{{ path('app_portfolio_perso_bloc_font_size', {'portfolioId': portfolioPerso.id, 'id': bloc.id, 'fontSize': '25px'}) }}">
                <button class="btn"><i class="fa-solid fa-text fa-xl"></i>
                    <br>
                    25px
                </button>
            </a>
        </div>
    </div>
    <div class="row g-2 {{ bloc.justify }} {{ bloc.direction }} align-items-center">
        {% for element in bloc.elements|sort((a, b) => a.ordre <=> b.ordre) %}
            {% set abstractElement = get_abstract_element(element.type) %}

            <div class="{{ element.colonne }} p-4">
                <button class="btn btn-light" type="button" data-bs-toggle="offcanvas"
                        data-bs-target="#offcanvasScrolling{{ element.id }}{{ element.bloc.id }}"
                        aria-controls="offcanvasScrolling"><i class="fa fa-cog"></i>
                </button>

                <div class="offcanvas offcanvas-start" data-bs-scroll="true"
                     data-bs-backdrop="false" tabindex="-1"
                     id="offcanvasScrolling{{ element.id }}{{ element.bloc.id }}"
                     aria-labelledby="offcanvasScrollingLabel">
                    <div class="offcanvas-header">
                        <h5 class="offcanvas-title" id="offcanvasScrollingLabel">
                            Paramètre de l'élément
                            {% if 'Paragraphe' in element.type %}
                                paragraphe
                            {% elseif 'Image' in element.type %}
                                image
                            {% endif %}
                        </h5>
                        <button type="button" class="btn-close"
                                data-bs-dismiss="offcanvas"
                                aria-label="Close"></button>
                    </div>
                    <div class="offcanvas-body">
                        <h6>Proportions</h6>
                        <button class="btn btn-light"
                                data-action="live#action"
                                data-action-name="setCol(elementId={{ element.id }}, col=3)"
                                {% if element.colonne == "col-3" %}
                                    disabled
                                {% endif %}
                        >
                            1/4
                        </button>
                        <button class="btn btn-light"
                                data-action="live#action"
                                data-action-name="setCol(elementId={{ element.id }}, col=6)"
                                {% if element.colonne == "col-6" %}
                        disabled
                                {% endif %}>
                            1/2
                        </button>
                        <button class="btn btn-light"
                                data-action="live#action"
                                data-action-name="setCol(elementId={{ element.id }}, col=9)"
                                {% if element.colonne == "col-9" %}
                        disabled
                                {% endif %}>
                            3/4
                        </button>
                        <button class="btn btn-light"
                                data-action="live#action"
                                data-action-name="setCol(elementId={{ element.id }}, col=12)"
                                {% if element.colonne == "col-12" %}
                        disabled
                                {% endif %}>
                            1/1
                        </button>
                        <hr>
                        {{ element_params_render(abstractElement, element, portfolioPerso) }}
                    </div>

                </div>

                {% if element.ordre != 1 %}
                    <button class="btn btn-light"
                            data-action="live#action"
                            data-action-name="upElement(elementId={{ element.id }})">
                        <i class="fa fa-arrow-up"></i>
                    </button>
                {% endif %}
                {% if element.ordre != bloc.elements|length %}
                    <button class="btn btn-light"
                            data-action="live#action"
                            data-action-name="downElement(elementId={{ element.id }})">
                        <i class="fa fa-arrow-down"></i>
                    </button>
                {% endif %}
                <button class="btn btn-danger"
                        data-action="live#action"
                        data-action-name="deleteElement(elementId={{ element.id }})">
                    <i class="fa fa-minus-square"></i>
                </button>

                {% if element.edit == true %}
                    <form action="{{ path('app_portfolio_perso_save_element', {'id': element.id, 'portfolioId': portfolioPerso.id}) }}"
                          method="post"

                          {% if 'Image' in element.type %}enctype="multipart/form-data"{% endif %}>

                        {{ element_form_render(abstractElement, element) }}

                        <button type="submit" class="btn btn-success">
                            <i class="fa fa-check-square"></i>
                        </button>
                        {#                        <button class="btn btn-success" #}
                        {#                                type="button" #}
                        {#                                data-action="live#action" #}
                        {#                                data-action-name="saveElement(elementId={{ element.id }})"> #}
                        {#                            <i class="fa fa-check-square"></i> #}
                        {#                        </button> #}
                    </form>
                {% else %}
                    {{ element_render(abstractElement, element) }}
                {% endif %}
            </div>
        {% endfor %}
    </div>

    <button type="button" data-bs-toggle="offcanvas"
            data-bs-target="#offCanva{{ bloc.id }}"
            aria-controls="offCanva{{ bloc.id }}"
            class="col-6 btn btn-light">
        <i class="fas fa-plus-circle"></i>
        <br>
        <small class="text-muted">
            Ajouter un nouvel élément
        </small>
    </button>

    <div class="offcanvas offcanvas-start" data-bs-scroll="true" tabindex="-1"
         id="offCanva{{ bloc.id }}"
         data-bs-backdrop="false"
         aria-labelledby="offCanva{{ bloc.id }}Label">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="offCanva{{ bloc.id }}Label">Elements</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas"
                    aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            {% for key, element in this.elements %}
                <button class="btn"
                        data-action="live#action"
                        data-action-name="newElement(blocId={{ bloc.id }}, type={{ key }})">
                    <i class="{{ constant(key ~ '::ICON') }} fa-xl"></i>
                    <br>
                    {{ element.name }}
                </button>
            {% endfor %}
        </div>
    </div>
</div>